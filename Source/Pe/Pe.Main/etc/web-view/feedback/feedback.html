<!DOCTYPE html>
<html lang="${HTML-TEMPLATE-LANG}">
<head>
	<meta charset="utf-8" />
	<title><!--${FEEDBACK-TITLE}--></title>
	<!--<script>/*${HTML-TEMPLATE-JQUERY}*/</script>-->
	<script>/*${HTML-TEMPLATE-MARKED}*/</script>
	<!--<script>/*${FEEDBACK-TEMPLATE-SCRIPT}*/</script>-->
	<!--<style>/*${HTML-TEMPLATE-BASIC-STYLE}*/</style>-->
	<style>/*${FEEDBACK-TEMPLATE-STYLE}*/</style>
	<script>
		function updatePreview(markdownSource) {
			//const contentElement = document.getElementById('content');
			const previewElement = document.getElementById('preview');
			//const markdownSource = contentElement.value;
			const markdownHtmlSource = marked(markdownSource, {});
			previewElement.innerHTML = markdownHtmlSource;
		}
		/*
		function setKindFormatCore(contentElement) {
			const kindElement = document.getElementById('kind');
			var kind = kindElement.value;
			var kindFormats = {
				'${FEEDBACK-KIND-BUG:S}': '${FEEDBACK-SET-KIND-BUG:S}',
				'${FEEDBACK-KIND-PROPOSAL:S}': '${FEEDBACK-SET-KIND-PROPOSAL:S}',
				'${FEEDBACK-KIND-OTHERS:S}': '${FEEDBACK-SET-KIND-OTHERS:S}',
			};
			var value = kindFormats[kind];
			contentElement.value = value;
		}

		function setKindFormat() {
			const contentElement = document.getElementById('content');
			//TODO: 入力破棄確認
			setKindFormatCore(contentElement);
			updatePreview();
		}

		window.addEventListener('load', ev => {
			const contentElement = document.getElementById('content');
			contentElement.addEventListener('keyup', ev => updatePreview())

			const commandKindElement = document.getElementById('command-kind');
			commandKindElement.addEventListener('click', ev => setKindFormat());
		});

		function checkAndFeedback(value, element, func) {
			var result = func(value);
			if (result) {
				element.classList.remove('error');
			} else {
				element.classList.add('error');
			}
			return result;
		}

		function getInputValues() {
			const kindElement = document.getElementById('kind');
			const subjectElement = document.getElementById('subject');
			const contentElement = document.getElementById('content');
			const data = {
				kind: kindElement.value,
				subject: subjectElement.value.trim(),
				content: contentElement.value.trim(),
			};

			//TODO: 種類確認

			// 件名確認
			const subjectIsValid = checkAndFeedback(data.subject, subjectElement, s => {
				return s.length;
			});

			// 内容確認
			const contentIsValid = checkAndFeedback(data.content, contentElement, s => {
				return s.length;
			});

			if (!subjectIsValid || !contentIsValid) {
				throw "ERROR!";
			}

			return JSON.stringify(data);
		}
		*/
	</script>
</head>
<body>
	<!--<section id="description">
		<p>${FEEDBACK-DESCRIPTION}</p>
		<p>${FEEDBACK-WARNING}</p>
		<p>IME 死んでるマン参上！</p>
	</section>

	<dl id="input-area">
		<dt>${FEEDBACK-SUBJECT}</dt>
		<dd>
			<input id="subject" type="text" />
		</dd>

		<dt>${FEEDBACK-KIND}</dt>
		<dd>
			<select id="kind">
				${FEEDBACK-KIND-OPTIONS}
			</select>
			<button id="command-kind">${FEEDBACK-KIND-SET}</button>
		</dd>

		<dt>${FEEDBACK-COMMENT}(${FEEDBACK-FORMAT})</dt>
		<dd id="comment">
			<table class="content-area">
				<tr>
					<th class="input">${FEEDBACK-CONTENT}</th>
					<th class="preview">${FEEDBACK-PREVIEW}</th>
				</tr>
				<tr>
					<td><textarea id="content"></textarea></td>
					<td><div id="preview"></div></td>
				</tr>
			</table>
		</dd>
	</dl>-->
	<div id="preview"></div>
</body>
</html>
