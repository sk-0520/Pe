parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"jlmp":[function(require,module,exports) {
var define;
var e;function t(e,t){return a(e)||r(e,t)||n()}function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var l,i=e[Symbol.iterator]();!(r=(l=i.next()).done)&&(n.push(l.value),!t||n.length!==t);r=!0);}catch(u){a=!0,o=u}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}function a(e){if(Array.isArray(e))return e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function u(e){return y(e)||m(e)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function m(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function y(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(t){if("object"===("undefined"==typeof module?"undefined":d(module))&&"object"===d(module.exports)){var n=t(require,exports);void 0!==n&&(module.exports=n)}else"function"==typeof e&&e.amd&&e(["require","exports"],t)}(function(e,n){"use strict";var r;!function(e){e[e.left=0]="left",e[e.center=1]="center",e[e.right=2]="right"}(r||(r={}));var a,l=new Map([["integer","integer"],["real","real"],["text","text"],["blob","blob"],["datetime","text"],["boolean","integer"]]),c=new Map([["integer",["System.Int64"]],["real",["System.Decimal","System.Single","System.Double"]],["text",["System.String","System.Guid","System.Version","System.TimeSpan"]],["blob",["System.Byte[]"]],["datetime",["System.DateTime","System.String"]],["boolean",["System.Boolean","System.Int64"]]]),m=["CreatedTimestamp","CreatedAccount","CreatedProgramName","CreatedProgramVersion"],y=["UpdatedTimestamp","UpdatedAccount","UpdatedProgramName","UpdatedProgramVersion","UpdatedCount"];!function(e){e[e.PrimaryKey=0]="PrimaryKey",e[e.NotNull=1]="NotNull",e[e.ForeignKey=2]="ForeignKey",e[e.LogicalColumnName=3]="LogicalColumnName",e[e.PhysicalColumnName=4]="PhysicalColumnName",e[e.LogicalType=5]="LogicalType",e[e.ClrType=6]="ClrType",e[e.CheckConstraint=7]="CheckConstraint",e[e.Comment=8]="Comment"}(a||(a={}));var d,s,f,v,h=u((d=new Map([[a.PrimaryKey,"PK"],[a.NotNull,"NN"],[a.ForeignKey,"FK"],[a.LogicalColumnName,"論理カラム名"],[a.PhysicalColumnName,"物理カラム名"],[a.LogicalType,"論理データ型"],[a.ClrType,"マッピング型"],[a.CheckConstraint,"チェック制約"],[a.Comment,"コメント"]])).keys()).sort().map(function(e){return d.get(e)}),p=["UK","カラム(CSV)"];function b(e,t){return e.querySelector('[name="'+t+'"]')}function g(e,t){return e.querySelectorAll('[name="'+t+'"]')}function C(e,t){for(;e.parentElement;){if(t(e.parentElement))return e.parentElement;e=e.parentElement}return null}function k(e){return"o"===e}function w(e){return e?"o":""}function x(e){if(!e||!e.length)return 0;var t=e.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]|[^\uD800-\uDFFF]/g)||[],n=0,r=!0,a=!1,o=void 0;try{for(var l,i=t[Symbol.iterator]();!(r=(l=i.next()).done);r=!0){var u=l.value;1==u.length?u.match(/[^\x01-\x7E]/)&&u.match(/[^\uFF65-\uFF9F]/)?n+=2:n+=1:n+=2}}catch(c){a=!0,o=c}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}!function(e){e.TableName="table-name"}(s||(s={})),function(e){e.LayoutRowRoot="layout-row-root",e.LayoutRowAdd="add",e.PrimaryKey="pk",e.NotNull="nn",e.ForeignKeyRoot="fk-root",e.ForeignKey="fk",e.ForeignKeyTable="fk-table",e.ForeignKeyColumn="fk-column",e.LogicalColumnName="name-logical",e.PhysicalColumnName="name-physical",e.LogicalType="data-logical",e.PhysicalType="data-physical",e.ClrType="data-clr",e.CheckConstraint="check",e.Comment="comment",e.Delete="delete"}(f||(f={})),function(e){e.IndexRowRoot="index-row-root",e.IndexRowAdd="add",e.ColumnAdd="add-col",e.IndexRowColumnRoot="index-row-column-root",e.ColumnName="c",e.UniqueKey="uk",e.Columns="columns",e.Column="column",e.DeleteColumn="delete-col",e.DeleteIndex="delete"}(v||(v={}));var N=function(){function e(t){o(this,e),this.tableNamePrefix="## ",this.entities=[],this.blockElements=t}return i(e,[{key:"getIndex",value:function(e){var t,n=/^###\s*layout\s*/,r=/^###\s*index\s*/;!function(e){e[e.Table=0]="Table",e[e.Layout=1]="Layout",e[e.Index=2]="Index"}(t||(t={}));for(var a=t.Table,o={table:-1,layout:{head:-1,tail:-1},index:{head:-1,tail:-1}},l=0;l<e.length;l++){var i=e[l];switch(a){case t.Table:i.startsWith(this.tableNamePrefix)&&(o.table=l,a=t.Layout);break;case t.Layout:n.test(i)&&(o.layout.head=l+1,a=t.Index);break;case t.Index:if(r.test(i))return o.layout.tail=l,o.index.head=l+1,o.index.tail=e.length,o;break;default:throw"こねーよ！"}}throw"はい、定義ミス"}},{key:"trimMarkdownTable",value:function(e){return e.map(function(e){return e.trim()}).filter(function(e){return e.startsWith("|")&&e.endsWith("|")})}},{key:"trimDefine",value:function(e){return{table:e.table.substr(this.tableNamePrefix.length),layout:this.trimMarkdownTable(e.layout),index:this.trimMarkdownTable(e.index)}}},{key:"convertRowLines",value:function(e){var t=e.map(function(e){return e.replace(/(^\|)|(|$)/,"")}).map(function(e){return e.split("|").map(function(e){return e.trim()})});return 2<t.length?t.slice(2):[]}},{key:"buildTable",value:function(e,t){var n=document.getElementById("template-table"),r=document.importNode(n.content,!0);b(r,s.TableName).value=t,e.appendChild(r)}},{key:"createLayoutRowNode",value:function(e){var t=document.getElementById("template-layout-row"),n=document.importNode(t.content,!0),r=b(n,f.PrimaryKey),o=b(n,f.NotNull);r.checked=k(e[a.PrimaryKey]),o.checked=k(e[a.NotNull]),r.addEventListener("change",function(e){o.disabled=r.checked,r.checked&&(o.checked=!0)}),r.dispatchEvent(new Event("change")),b(n,f.ForeignKey).value=e[a.ForeignKey],b(n,f.LogicalColumnName).value=e[a.LogicalColumnName],b(n,f.PhysicalColumnName).value=e[a.PhysicalColumnName];var i=b(n,f.LogicalType),u=b(n,f.PhysicalType),m=b(n,f.ClrType);return i.value=e[a.LogicalType],m.value=e[a.ClrType],i.addEventListener("change",function(e){var t=l.get(i.value);u.value=t||"なんかデータ変";var n=m.querySelectorAll("option"),r=null,a=null,o=!0,y=!1,d=void 0;try{for(var s,f=n[Symbol.iterator]();!(o=(s=f.next()).done);o=!0){var v=s.value,h=c.get(i.value);v.disabled=!h.some(function(e){return e===v.value}),v.disabled||a||h[0]===v.value&&(a=v),v.selected&&(r=v)}}catch(p){y=!0,d=p}finally{try{o||null==f.return||f.return()}finally{if(y)throw d}}r&&r.disabled&&(a.selected=!0)}),i.dispatchEvent(new Event("change")),b(n,f.CheckConstraint).value=e[a.CheckConstraint],b(n,f.Comment).value=e[a.Comment],b(n,f.Delete).addEventListener("click",function(e){for(var t=e.srcElement;t.getAttribute("name")!==f.LayoutRowRoot;)t=t.parentElement;t.remove()}),n}},{key:"createEmptyLayout",value:function(){var e=new Map([[a.PrimaryKey,""],[a.NotNull,""],[a.ForeignKey,""],[a.LogicalColumnName,""],[a.PhysicalColumnName,""],[a.LogicalType,"integer"],[a.ClrType,c.get("integer")[0]],[a.CheckConstraint,""],[a.Comment,""]]);return u(e.keys()).sort().map(function(t){return e.get(t)})}},{key:"buildLayout",value:function(e,t){var n=this,r=document.getElementById("template-layout"),a=document.importNode(r.content,!0),o=a.querySelector("tbody"),l=!0,i=!1,u=void 0;try{for(var c,m=t[Symbol.iterator]();!(l=(c=m.next()).done);l=!0){var y=c.value,d=this.createLayoutRowNode(y);o.appendChild(d)}}catch(s){i=!0,u=s}finally{try{l||null==m.return||m.return()}finally{if(i)throw u}}b(a,f.LayoutRowAdd).addEventListener("click",function(e){for(var t=e.srcElement;"TABLE"!==t.tagName;)t=t.parentElement;var r=n.createEmptyLayout(),a=n.createLayoutRowNode(r);o.appendChild(a);var l=b(o.lastElementChild,f.ForeignKeyTable),i=n.filterMyself(n.entities),u=n.getTableNamesFromEntities(i);n.buildForeignKeyTable(l,u),l.addEventListener("change",function(e){return n.changedTableElement(e,i)})}),e.appendChild(a)}},{key:"createIndexRowColumnNode",value:function(e){var t=document.getElementById("template-index-row-column"),n=document.importNode(t.content,!0);return b(n,v.ColumnName).value=e,b(n,v.DeleteColumn).addEventListener("click",function(e){C(e.srcElement,function(e){return e.getAttribute("name")===v.IndexRowColumnRoot}).remove()}),n}},{key:"createIndexRowNode",value:function(e,t){var n=this,r=document.getElementById("template-index-row"),a=document.importNode(r.content,!0);b(a,v.UniqueKey).checked=e;var o=b(a,v.Columns),l=!0,i=!1,u=void 0;try{for(var c,m=t[Symbol.iterator]();!(l=(c=m.next()).done);l=!0){var y=c.value,d=this.createIndexRowColumnNode(y);o.appendChild(d)}}catch(s){i=!0,u=s}finally{try{l||null==m.return||m.return()}finally{if(i)throw u}}return b(a,v.ColumnAdd).addEventListener("click",function(e){var t=n.createIndexRowColumnNode(n.getColumnNames(!0)[0]);o.appendChild(t);var r=n.getColumnNames(!0),a=b(o.lastElementChild,v.Column);n.setIndexColumnNames(a,r)}),b(a,v.DeleteIndex).addEventListener("click",function(e){C(e.srcElement,function(e){return e.getAttribute("name")===v.IndexRowRoot}).remove()}),a}},{key:"buildIndex",value:function(e,t){var n=this,r=document.getElementById("template-index"),a=document.importNode(r.content,!0),o=a.querySelector("tbody"),l=!0,i=!1,u=void 0;try{for(var c,m=t[Symbol.iterator]();!(l=(c=m.next()).done);l=!0){var y=c.value,d=k(y[0]),s=y[1].split(",").map(function(e){return e.trim()}),f=this.createIndexRowNode(d,s);o.appendChild(f)}}catch(h){i=!0,u=h}finally{try{l||null==m.return||m.return()}finally{if(i)throw u}}b(a,v.IndexRowAdd).addEventListener("click",function(e){var t=n.createIndexRowNode(!1,[n.getColumnNames(!0)[0]]);o.appendChild(t);var r=b(o.lastElementChild,v.Column),a=n.getColumnNames(!0);n.setIndexColumnNames(r,a)}),e.appendChild(a)}},{key:"build",value:function(e){var t=e.split(/\r?\n/gm),n=this.getIndex(t),r=this.trimDefine({table:t[n.table],layout:t.slice(n.layout.head,n.layout.tail),index:t.slice(n.index.head,n.index.tail)});this.buildTable(this.blockElements.table,r.table),this.buildLayout(this.blockElements.layout,this.convertRowLines(r.layout)),this.buildIndex(this.blockElements.index,this.convertRowLines(r.index))}},{key:"getTableName",value:function(){return b(this.blockElements.table,s.TableName).value}},{key:"buildForeignKeyTable",value:function(e,t){e.appendChild(document.createElement("option"));var n=!0,r=!1,a=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var i=o.value,u=document.createElement("option");u.value=i,u.textContent=i,e.appendChild(u)}}catch(c){r=!0,a=c}finally{try{n||null==l.return||l.return()}finally{if(r)throw a}}}},{key:"getColumnNames",value:function(e){var t=function(e){return!!m.some(function(t){return t===e})||!!y.some(function(t){return t===e})},n=g(this.blockElements.layout,f.PhysicalColumnName),r=new Array,a=!0,o=!1,l=void 0;try{for(var i,u=n[Symbol.iterator]();!(a=(i=u.next()).done);a=!0){var c=i.value;e&&t(c.value)||r.push(c.value)}}catch(d){o=!0,l=d}finally{try{a||null==u.return||u.return()}finally{if(o)throw l}}return r}},{key:"buildForeignKeyColumns",value:function(e,t){e.textContent="";var n=t.getColumnNames(!0),r=!0,a=!1,o=void 0;try{for(var l,i=n[Symbol.iterator]();!(r=(l=i.next()).done);r=!0){var u=l.value,c=document.createElement("option");c.value=u,c.textContent=u,e.appendChild(c)}}catch(m){a=!0,o=m}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}}},{key:"filterMyself",value:function(e){var t=this;return e.filter(function(e){return e!==t})}},{key:"getTableNamesFromEntities",value:function(e){return e.map(function(e){return e.getTableName()}).sort()}},{key:"changedTableElement",value:function(e,t){var n=e.srcElement,r=b(n.parentElement,f.ForeignKeyColumn),a=t.find(function(e){return e.getTableName()==n.value});a?(r.disabled=!1,this.buildForeignKeyColumns(r,a)):(r.disabled=!0,r.textContent="")}},{key:"buildEntityForeignKey",value:function(e){var t=this,n=g(this.blockElements.layout,f.ForeignKeyRoot),r=!0,a=!1,o=void 0;try{for(var l,i=n[Symbol.iterator]();!(r=(l=i.next()).done);r=!0){var u=l.value,c=b(u,f.ForeignKeyTable),m=b(u,f.ForeignKeyColumn),y=this.filterMyself(e),d=this.getTableNamesFromEntities(y);this.buildForeignKeyTable(c,d),c.addEventListener("change",function(e){return t.changedTableElement(e,y)});var s=b(u,f.ForeignKey);if(s.value){var v=s.value.split("."),h={table:v[0].trim(),column:v[1].trim()};c.value=h.table,c.dispatchEvent(new Event("change")),m.value=h.column}else c.dispatchEvent(new Event("change"));s.value=""}}catch(p){a=!0,o=p}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}}},{key:"setIndexColumnNames",value:function(e,t){var n=!0,r=!1,a=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var i=o.value,u=document.createElement("option");u.value=i,u.textContent=i,e.appendChild(u)}}catch(c){r=!0,a=c}finally{try{n||null==l.return||l.return()}finally{if(r)throw a}}}},{key:"buildEntityIndex",value:function(){var e=this.getColumnNames(!0),t=g(this.blockElements.index,v.IndexRowRoot),n=!0,r=!1,a=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var i=g(o.value,v.Column),u=!0,c=!1,m=void 0;try{for(var y,d=i[Symbol.iterator]();!(u=(y=d.next()).done);u=!0){var s=y.value;this.setIndexColumnNames(s,e),s.value=b(s.parentElement,v.ColumnName).value}}catch(f){c=!0,m=f}finally{try{u||null==d.return||d.return()}finally{if(c)throw m}}}}catch(f){r=!0,a=f}finally{try{n||null==l.return||l.return()}finally{if(r)throw a}}}},{key:"buildEntities",value:function(e){this.entities=e,this.buildEntityForeignKey(this.entities),this.buildEntityIndex()}}]),e}(),E=function(){function e(t,n,r,a){o(this,e),this.entities=[],this.viewElement=t,this.commandElement=n,this.defineElement=r,this.sqlElement=a}return i(e,[{key:"createBlockElements",value:function(){var e=document.getElementById("template-block"),t=document.importNode(e.content,!0);return{root:t.querySelector('[name="block-root"]'),table:t.querySelector('[name="block-table"]'),layout:t.querySelector('[name="block-layout"]'),index:t.querySelector('[name="block-index"]')}}},{key:"buildCommand",value:function(e){var t=this,n=document.getElementById("template-command"),r=document.importNode(n.content,!0);r.querySelector('[name="command-export"]').addEventListener("click",function(e){t.export()}),r.querySelector('[name="command-copy-define"]').addEventListener("click",function(e){t.copyDefine()}),r.querySelector('[name="command-copy-sql"]').addEventListener("click",function(e){t.copySql()}),e.appendChild(r)}},{key:"buildEntityMapping",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){a.value.buildEntities(e)}}catch(l){n=!0,r=l}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"build",value:function(){this.buildCommand(this.commandElement);var e=this.defineElement.value.split("___");e.shift();var t=!0,n=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var l=a.value,i=this.createBlockElements(),u=new N(i);u.build(l),this.entities.push(u),this.viewElement.appendChild(i.root)}}catch(c){n=!0,r=c}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.buildEntityMapping(this.entities)}},{key:"reset",value:function(){this.entities=[],this.viewElement.textContent="",this.commandElement.textContent=""}},{key:"exportTable",value:function(e){return b(e,s.TableName).value}},{key:"getLayoutRowData",value:function(e){var t={isPrimary:b(e,f.PrimaryKey).checked,isNotNull:b(e,f.NotNull).checked,foreignTable:"",foreignColumn:"",columnName:b(e,f.PhysicalColumnName).value,logicalName:b(e,f.LogicalColumnName).value,databaseType:b(e,f.LogicalType).value,clrType:b(e,f.ClrType).value,check:b(e,f.CheckConstraint).value,comment:b(e,f.Comment).value},n=b(e,f.ForeignKeyTable).value,r=b(e,f.ForeignKeyColumn).value;return n.length&&r.length&&(t.foreignTable=n,t.foreignColumn=r),t}},{key:"toLayoutMarkdown",value:function(e){var t=new Map([[a.PrimaryKey,w(e.isPrimary)],[a.NotNull,w(e.isNotNull)],[a.ForeignKey,e.foreignTable.length&&e.foreignColumn.length?"".concat(e.foreignTable,".").concat(e.foreignColumn):""],[a.LogicalColumnName,e.logicalName],[a.PhysicalColumnName,e.columnName],[a.LogicalType,e.databaseType],[a.ClrType,e.clrType],[a.CheckConstraint,e.check],[a.Comment,e.comment]]);return u(t.keys()).sort().map(function(e){return t.get(e)})}},{key:"toLayoutDatabase",value:function(e){var t="[".concat(e.columnName,"] ").concat(e.databaseType);return e.isNotNull&&(t+=" not null"),e.check.length&&(t+=" check( ".concat(e.check," )")),(e.logicalName.length||e.comment.length)&&(t+=" /* ".concat(e.logicalName),e.logicalName.length&&(t+=" "),t+=e.comment,t+=" */"),t}},{key:"getMarkdownCellSpace",value:function(e){for(var t=new Array(e[0].length).fill(0),n=0;n<e[0].length;n++){var r=!0,a=!1,o=void 0;try{for(var l,i=e[Symbol.iterator]();!(r=(l=i.next()).done);r=!0){var u=x(l.value[n]);t[n]=Math.max(t[n],u)}}catch(c){a=!0,o=c}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}}return t}},{key:"toMarkdownCell",value:function(e,t,n){var a=x(e);if(a==t)return e;switch(n){case r.left:return e+" ".repeat(t-a);case r.right:return" ".repeat(t-a)+e;case r.center:return" ".repeat((t-a)/2)+e+" ".repeat((t-a)/2+(t-a)%2)}}},{key:"toMarkdownTableCells",value:function(e,t,n){for(var a=new Array(e.length),o=0;o<e.length;o++){var l=t.get(o)||r.left,i=this.toMarkdownCell(e[o],n[o],l);a[o]=i}return a}},{key:"toMarkdown",value:function(e,t,n){var a=this.getMarkdownCellSpace([e].concat(n)),o=new Array;o.push("| "+this.toMarkdownTableCells(e,t,a).join(" | ")+" |");for(var l="|",i=0;i<e.length;i++){switch(t.get(i)||r.left){case r.center:l+=":"+"-".repeat(a[i])+":";break;case r.right:l+="-".repeat(a[i]+1)+":";break;case r.left:l+=":"+"-".repeat(a[i]+1)}l+="|"}o.push(l);var u=!0,c=!1,m=void 0;try{for(var y,d=n[Symbol.iterator]();!(u=(y=d.next()).done);u=!0){var s=y.value;o.push("| "+this.toMarkdownTableCells(s,t,a).join(" | ")+" |")}}catch(f){c=!0,m=f}finally{try{u||null==d.return||d.return()}finally{if(c)throw m}}return o.join("\r\n")}},{key:"exportLayout",value:function(e,n){var o=g(n,f.LayoutRowRoot),l=new Array,i=new Array,u=new Array,c=new Map,m=!0,y=!1,d=void 0;try{for(var s,v=o[Symbol.iterator]();!(m=(s=v.next()).done);m=!0){var p=s.value,b=this.getLayoutRowData(p),C=this.toLayoutMarkdown(b);l.push(C);var k=this.toLayoutDatabase(b);if(i.push(k),b.isPrimary&&u.push(b.columnName),b.foreignTable.length&&b.foreignColumn.length)c.has(b.foreignTable)||c.set(b.foreignTable,new Array),c.get(b.foreignTable).push({column:b.columnName,targetColumn:b.foreignColumn})}}catch(R){y=!0,d=R}finally{try{m||null==v.return||v.return()}finally{if(y)throw d}}var w={markdown:this.toMarkdown(h,new Map([[a.PrimaryKey,r.center],[a.NotNull,r.center]]),l),database:""},x="create table [".concat(e,"] (\r\n");if(x+="\t"+i.join(",\r\n\t"),u.length&&(x+=",\r\n",x+="\tprimary key(\r\n",x+="\t\t"+u.map(function(e){return"[".concat(e,"]")}).join(",\r\n\t\t"),x+="\r\n\t)"),c.size){var N=!0,E=!1,T=void 0;try{for(var S,L=c[Symbol.iterator]();!(N=(S=L.next()).done);N=!0){var I=t(S.value,2),F=I[0],K=I[1];x+=",\r\n",x+="\tforeign key(".concat(K.map(function(e){return"[".concat(e.column,"]")}).join(", "),") references [").concat(F,"](").concat(K.map(function(e){return"[".concat(e.targetColumn,"]")}).join(", "),")")}}catch(R){E=!0,T=R}finally{try{N||null==L.return||L.return()}finally{if(E)throw T}}}return x+="\r\n)\r\n",x+=";\r\n",w.database=x,w}},{key:"getIndexRowData",value:function(e){return{isUnique:b(e,v.UniqueKey).checked,columns:u(g(e,v.ColumnName)).map(function(e){return e.value})}}},{key:"toIndexMarkdown",value:function(e){var t=[w(e.isUnique)];return t.push.apply(t,u(e.columns)),t}},{key:"toIndexDatabase",value:function(e,t,n){var r="--// index: idx_".concat(e,"_").concat(t,"\r\n");return r+="create",n.isUnique&&(r+=" unique"),r+=" index",r+=" [idx_".concat(e,"_").concat(t,"]"),r+=" on",r+=" ".concat(e,"(\r\n"),r+=n.columns.map(function(e){return"\t[".concat(e,"]")}).join(",\r\n")+"\r\n",r+=")\r\n",r+=";\r\n"}},{key:"exportIndex",value:function(e,t){var n=g(t,v.IndexRowRoot),a=new Array,o=new Array;if(!n.length)return{markdown:"",database:""};var l=1,i=!0,u=!1,c=void 0;try{for(var m,y=n[Symbol.iterator]();!(i=(m=y.next()).done);i=!0){var d=m.value,s=this.getIndexRowData(d),f=this.toIndexMarkdown(s);a.push(f);var h=this.toIndexDatabase(e,l++,s);o.push(h)}}catch(b){u=!0,c=b}finally{try{i||null==y.return||y.return()}finally{if(u)throw c}}return{markdown:this.toMarkdown(p,new Map([[0,r.center]]),a),database:o.join("\r\n")}}},{key:"exportBlock",value:function(e){var t=b(e,"block-table"),n=this.exportTable(t),r=b(e,"block-layout"),a=this.exportLayout(n,r),o=b(e,"block-index");return{table:n,layout:a,index:this.exportIndex(n,o)}}},{key:"export",value:function(){var e=this,t=Array(),n=Array(),r=Array(),a=u(g(this.viewElement,"block-root")).map(function(t){return e.exportBlock(t)}),o=!0,l=!1,i=void 0;try{for(var c,m=a[Symbol.iterator]();!(o=(c=m.next()).done);o=!0){var y=c.value,d="\r\n___\r\n\r\n";d+="## ".concat(y.table,"\r\n"),d+="\r\n",d+="### layout\r\n",d+="\r\n",d+=y.layout.markdown,d+="\r\n",d+="\r\n",d+="### index\r\n",d+="\r\n",y.index.markdown.length?d+=y.index.markdown:d+="*NONE*",d+="\r\n",d+="\r\n",t.push(d);var s="--// table: ".concat(y.table,"\r\n");s+=y.layout.database,n.push(s),r.push(y.index.database)}}catch(f){l=!0,i=f}finally{try{o||null==m.return||m.return()}finally{if(l)throw i}}this.defineElement.value=t.join("\r\n"),this.sqlElement.value=n.join("\r\n")+"\r\n"+r.join("\r\n")}},{key:"copyElement",value:function(e){e.focus(),e.select(),document.execCommand("copy")}},{key:"copyDefine",value:function(){this.copyElement(this.defineElement)}},{key:"copySql",value:function(){this.copyElement(this.sqlElement)}}]),e}(),T=new Map([["main",new E(document.getElementById("view-main"),document.getElementById("command-main"),document.getElementById("define-main"),document.getElementById("sql-main"))],["file",new E(document.getElementById("view-file"),document.getElementById("command-file"),document.getElementById("define-file"),document.getElementById("sql-file"))]]),S=!0,L=!1,I=void 0;try{for(var F,K=T[Symbol.iterator]();!(S=(F=K.next()).done);S=!0){var R=t(F.value,2),A=(R[0],R[1]);A.build(),A.export()}}catch(P){L=!0,I=P}finally{try{S||null==K.return||K.return()}finally{if(L)throw I}}});
},{}]},{},["jlmp"], null)
//# sourceMappingURL=table.6d6a4924.js.map